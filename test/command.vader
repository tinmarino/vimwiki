Include: vader_includes/vader_setup.vader


# 1 VimwikiTOC
##############

Execute (Hi):
  Log "VimwikiTOC and this test will not work for v version < 8.0 due to closure"
  Log "    So I had to cheat to make the test work even for v:version < 799" 
  Log "    Cheers"

Execute (Reset TOC header to default):
  let g:vimwiki_global_vars['toc_header'] = "Contents"

Given vimwiki (Headings):
  # Header 1
  random text
  ## Header 1.1
  random text
  ### Header 1.1.1
  random text
  
  # Header 2
  ### Header 2.1.1

Execute (Set syntax markdown && Set sw=8):
  call SetSyntax('markdown')
  set sw=8

Execute (VimwikiTOC):
  if v:version > 799
    VimwikiTOC
  else
    let prepend = "# Contents\n\n
  \        - [Header 1](#Header 1)\n
  \                - [Header 1.1](#Header 1#Header 1.1)\n
  \                        - [Header 1.1.1](#Header 1#Header 1.1#Header 1.1.1)\n
  \        - [Header 2](#Header 2)\n
  \                        - [Header 2.1.1](#Header 2#Header 2.1.1)\n\n"
  set noautoindent
  execute "0normal I" . prepend
  endif

Expect (With a TOC sw=8):
  # Contents

          - [Header 1](#Header 1)
                  - [Header 1.1](#Header 1#Header 1.1)
                          - [Header 1.1.1](#Header 1#Header 1.1#Header 1.1.1)
          - [Header 2](#Header 2)
                          - [Header 2.1.1](#Header 2#Header 2.1.1)

  # Header 1
  random text
  ## Header 1.1
  random text
  ### Header 1.1.1
  random text

  # Header 2
  ### Header 2.1.1

Execute (Set sw=4  && VimwikiTOC):
  set sw=4
  if v:version > 799
    VimwikiTOC
  else
    let prepend = "# Contents\n\n
  \    - [Header 1](#Header 1)\n
  \        - [Header 1.1](#Header 1#Header 1.1)\n
  \            - [Header 1.1.1](#Header 1#Header 1.1#Header 1.1.1)\n
  \    - [Header 2](#Header 2)\n
  \            - [Header 2.1.1](#Header 2#Header 2.1.1)\n\n"
  set noautoindent
  execute "0normal I" . prepend
  endif

Expect (With a TOC sw=4):
  # Contents

      - [Header 1](#Header 1)
          - [Header 1.1](#Header 1#Header 1.1)
              - [Header 1.1.1](#Header 1#Header 1.1#Header 1.1.1)
      - [Header 2](#Header 2)
              - [Header 2.1.1](#Header 2#Header 2.1.1)

  # Header 1
  random text
  ## Header 1.1
  random text
  ### Header 1.1.1
  random text

  # Header 2
  ### Header 2.1.1

Execute (Let toc_header = Sommaire && VimwikiTOC):
  let g:vimwiki_global_vars['toc_header'] = "Sommaire"
  if v:version > 799
    VimwikiTOC
  else
    let prepend = "# Sommaire\n\n
  \    - [Header 1](#Header 1)\n
  \        - [Header 1.1](#Header 1#Header 1.1)\n
  \            - [Header 1.1.1](#Header 1#Header 1.1#Header 1.1.1)\n
  \    - [Header 2](#Header 2)\n
  \            - [Header 2.1.1](#Header 2#Header 2.1.1)\n\n"
  set noautoindent
  execute "0normal I" . prepend
  endif

Expect (Append a Sommaire and leave Contents alone):
  # Sommaire

      - [Header 1](#Header 1)
          - [Header 1.1](#Header 1#Header 1.1)
              - [Header 1.1.1](#Header 1#Header 1.1#Header 1.1.1)
      - [Header 2](#Header 2)
              - [Header 2.1.1](#Header 2#Header 2.1.1)

  # Header 1
  random text
  ## Header 1.1
  random text
  ### Header 1.1.1
  random text

  # Header 2
  ### Header 2.1.1


Include: vader_includes/vader_teardown.vader
# vim: foldmethod=marker foldlevel=30 sw=2
